<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>web analytics output</title>

    <style>
    .row {
      font-family: monospace;
      font-size: 8pt;
      white-space: pre;
      display: block;
      margin-top: 1em;
      border-top: 1px solid gray;
    }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="grid log-table">

      </div>
    </div> <!-- /container -->

    <script src="http://static.bcclabs.com/js-sdk/bcc.min.js"></script>

    <script type="text/javascript">

    // pre-defined input stuff would be code-genned
    var ctx = BCC.init('0d28ce45-c9a4-46ad-af53-d9823c515a0e');


    // test output

    // TODO: group by clicks, hits, and visitors by adkey
    //
    // use power quant channel and mdManager.getParameter()
    //
    // hits per minute by adkey1
    // concurrent per minute by adkey1

    var project = ctx.project('analytics');
    var logfeedmsg = function (f, m) {

      console.dir(m);

      var logentry = $('<div>').addClass('row');
      logentry.text(JSON.stringify(m, null, '\t'));
      $('.log-table').prepend(logentry);

      var rows = $('.row');
      var numrows = rows.length;
      if (numrows > 50) {
        rows[numrows-1].remove();
      }
    };

    project.feed({
      channel: 'daservlettest',
      name: 'o',
      onmsgreceived: logfeedmsg
    });

    </script>

  </body>
</html>